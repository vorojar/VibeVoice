// ===== 国际化 =====
const i18n = {
  zh: {
    "nav.preset": "预设说话人",
    "nav.clone": "语音克隆",
    "nav.design": "声音设计",
    "nav.api": "API 文档",
    "main.title": "文字转语音",
    "main.placeholder": "在此输入要转换的文本...",
    "config.title": "配置",
    "config.speaker": "说话人",
    "config.language": "语言",
    "config.instruct": "情感指令",
    "config.instructPlaceholder": "如：用开心的语气说",
    "config.refAudio": "参考音频",
    "config.refText": "参考文本",
    "config.refTextHint": "(可选，提高质量)",
    "config.refTextPlaceholder": "参考音频的文字内容",
    "config.preview": "音频预览",
    "config.voiceDesc": "声音描述",
    "config.voiceDescPlaceholder": "描述你想要的声音，如：低沉沙哑的中年男声",
    "config.saveName": "保存到声音库",
    "config.saveNamePlaceholder": "声音名称",
    "clone.voiceLibrary": "声音库",
    "clone.newVoice": "新建克隆声音",
    "btn.generate": "生成语音",
    "btn.record": "录音",
    "btn.stopRecord": "停止",
    "btn.upload": "上传文件",
    "btn.save": "保存",
    "btn.stop": "停止",
    "stats.chars": "字",
    "stats.sentences": "句",
    "status.generating": "生成中...",
    "status.success": "生成成功",
    "status.failed": "生成失败",
    "status.stopped": "已停止",
    "status.enterText": "请输入文本",
    "status.needAudio": "请录音或上传参考音频",
    "status.needVoiceOrAudio": "请选择声音或上传参考音频",
    "status.needDesc": "请输入声音描述",
    "status.modelLoading": "模型加载中...",
    "status.saved": "已保存",
    "status.saving": "保存中...",
    "api.title": "API 文档",
    "api.presetTTS": "预设说话人 TTS",
    "api.cloneTTS": "语音克隆",
    "api.designTTS": "声音设计",
    "api.voiceLibrary": "声音库管理",
    "confirm.delete": "确定删除此声音？",
    "btn.regenerate": "重新生成",
    "status.regenerating": "重新生成中...",
    "status.inserting": "正在生成新句子...",
    "btn.editSentence": "编辑",
    "btn.undo": "撤销",
    "btn.addSentence": "添加句子",
    "btn.insertHint": "输入新句子文本",
    "confirm.deleteSentence": "确定删除这句？",
    "label.pace": "句间停顿",
    "label.paceOff": "无",
    "label.paceSlow": "慢",
    "label.paceFast": "快",
    "label.instructEmpty": "点击设置情感",
    "label.instructLabel": "情感",
    "label.voiceLabel": "声音",
    "label.voiceDefault": "默认",
    "btn.previewSentences": "分句预览",
    "btn.startGenerate": "生成语音",
    "btn.backToInput": "返回编辑",
    "btn.newProject": "新建",
    "confirm.newProject": "清空当前内容，重新开始？",
    "tab.preset": "预设",
    "tab.clone": "克隆",
    "tab.design": "设计",
    "tab.library": "声音库",
    "sidebar.history": "历史记录",
    "history.empty": "暂无历史记录",
    "status.selectVoice": "请选择一个声音",
    "status.paragraph": "段落",
    "btn.analyzeCharacters": "智能分析",
    "btn.reanalyze": "重新分析",
    "analyze.loading": "正在加载分析模型...",
    "analyze.analyzing": "正在分析角色和情感...",
    "analyze.success": "分析完成",
    "analyze.failed": "分析失败",
    "analyze.characters": "角色清单",
    "analyze.sentences": "句",
    "analyze.narrator": "旁白",
    "design.newVoice": "新建设计声音",
    "design.previewText": "试听文本",
    "design.previewTextPlaceholder": "输入一段话让声音朗读...",
    "design.preview": "生成预览",
    "design.generating": "生成中...",
    "design.saveSuccess": "声音已保存到声音库",
  },
  en: {
    "nav.preset": "Preset Voices",
    "nav.clone": "Voice Clone",
    "nav.design": "Voice Design",
    "nav.api": "API Docs",
    "main.title": "Text to Speech",
    "main.placeholder": "Enter text to convert...",
    "config.title": "Settings",
    "config.speaker": "Speaker",
    "config.language": "Language",
    "config.instruct": "Emotion",
    "config.instructPlaceholder": "e.g., speak happily",
    "config.refAudio": "Reference Audio",
    "config.refText": "Reference Text",
    "config.refTextHint": "(optional)",
    "config.refTextPlaceholder": "Transcript of reference audio",
    "config.preview": "Preview",
    "config.voiceDesc": "Voice Description",
    "config.voiceDescPlaceholder": "Describe the voice you want",
    "config.saveName": "Save to Library",
    "config.saveNamePlaceholder": "Voice name",
    "clone.voiceLibrary": "Voice Library",
    "clone.newVoice": "New Clone Voice",
    "btn.generate": "Generate",
    "btn.record": "Record",
    "btn.stopRecord": "Stop",
    "btn.upload": "Upload",
    "btn.save": "Save",
    "btn.stop": "Stop",
    "stats.chars": "chars",
    "stats.sentences": "sentences",
    "status.generating": "Generating...",
    "status.success": "Success",
    "status.failed": "Failed",
    "status.stopped": "Stopped",
    "status.enterText": "Please enter text",
    "status.needAudio": "Please record or upload audio",
    "status.needVoiceOrAudio": "Please select a voice or upload audio",
    "status.needDesc": "Please enter voice description",
    "status.modelLoading": "Loading model...",
    "status.saved": "Saved",
    "status.saving": "Saving...",
    "api.title": "API Documentation",
    "api.presetTTS": "Preset Voice TTS",
    "api.cloneTTS": "Voice Cloning",
    "api.designTTS": "Voice Design",
    "api.voiceLibrary": "Voice Library",
    "confirm.delete": "Delete this voice?",
    "btn.regenerate": "Regenerate",
    "status.regenerating": "Regenerating...",
    "status.inserting": "Generating new sentence...",
    "btn.editSentence": "Edit",
    "btn.undo": "Undo",
    "btn.addSentence": "Add sentence",
    "btn.insertHint": "Enter new sentence text",
    "confirm.deleteSentence": "Delete this sentence?",
    "label.pace": "Pause",
    "label.paceOff": "Off",
    "label.paceSlow": "Slow",
    "label.paceFast": "Fast",
    "label.instructEmpty": "Click to set emotion",
    "label.instructLabel": "Emotion",
    "label.voiceLabel": "Voice",
    "label.voiceDefault": "Default",
    "btn.previewSentences": "Preview",
    "btn.startGenerate": "Generate",
    "btn.backToInput": "Back to input",
    "btn.newProject": "New",
    "confirm.newProject": "Clear current content and start over?",
    "tab.preset": "Preset",
    "tab.clone": "Clone",
    "tab.design": "Design",
    "tab.library": "Library",
    "sidebar.history": "History",
    "history.empty": "No history yet",
    "status.selectVoice": "Please select a voice",
    "status.paragraph": "Paragraph",
    "btn.analyzeCharacters": "Smart Analyze",
    "btn.reanalyze": "Re-analyze",
    "analyze.loading": "Loading analyzer model...",
    "analyze.analyzing": "Analyzing characters and emotions...",
    "analyze.success": "Analysis complete",
    "analyze.failed": "Analysis failed",
    "analyze.characters": "Characters",
    "analyze.sentences": "sentences",
    "analyze.narrator": "Narrator",
    "design.newVoice": "New Design Voice",
    "design.previewText": "Preview Text",
    "design.previewTextPlaceholder": "Enter some text for the voice to read...",
    "design.preview": "Generate Preview",
    "design.generating": "Generating...",
    "design.saveSuccess": "Voice saved to library",
  },
};

function t(key) {
  return i18n[currentLang][key] || key;
}

function updateI18n() {
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    el.textContent = t(el.dataset.i18n);
  });
  document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
    el.placeholder = t(el.dataset.i18nPlaceholder);
  });
  document.getElementById("lang-toggle").textContent =
    currentLang === "zh" ? "EN" : "中";
  renderStats();
}

function toggleLanguage() {
  currentLang = currentLang === "zh" ? "en" : "zh";
  localStorage.setItem("lang", currentLang);
  updateI18n();
}
